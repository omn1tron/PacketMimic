# PacketMimic VPN Protocol

PacketMimic - —ç—Ç–æ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π VPN –ø—Ä–æ—Ç–æ–∫–æ–ª –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ —Ç—É–Ω–Ω–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è IP —Ç—Ä–∞—Ñ–∏–∫–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Å–∏–ª—å–Ω–æ–≥–æ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏.

## –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- üîí **–®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ AES-256-GCM** - —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–µ —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —Å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π
- üöÄ **–í—ã—Å–æ–∫–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** - —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è –∏–Ω–∫–∞–ø—Å—É–ª—è—Ü–∏—è –ø–∞–∫–µ—Ç–æ–≤
- üîê **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è** - –∑–∞—â–∏—Ç–∞ –æ—Ç –Ω–µ—Å–∞–Ω–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞
- üí™ **Keepalive –º–µ—Ö–∞–Ω–∏–∑–º** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —Ä–∞–∑—Ä—ã–≤–æ–≤ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
- üõ°Ô∏è **–ü–µ—Ä–µ—Ö–≤–∞—Ç —Ç—Ä–∞—Ñ–∏–∫–∞** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ—Ö–≤–∞—Ç –∏ –∞–Ω–∞–ª–∏–∑ —Å–µ—Ç–µ–≤–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞
- üö´ **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Ç—Ä–∞—Ñ–∏–∫–∞ (Snort-like)** - —Å–∏—Å—Ç–µ–º–∞ –ø—Ä–∞–≤–∏–ª –¥–ª—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞
- üìä **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞** - –¥–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–µ—Ä–µ—Ö–≤–∞—á–µ–Ω–Ω–æ–≥–æ –∏ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞
- üåê **–≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω—ã–π TUN (Linux)** - —Ä–µ–∞–ª—å–Ω–æ–µ —Ç—É–Ω–Ω–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ IP —á–µ—Ä–µ–∑ TUN –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
- üì¶ **–ü—Ä–æ—Å—Ç–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** - –ª–µ–≥–∫–æ —Ä–∞—Å—à–∏—Ä—è–µ–º—ã–π –ø—Ä–æ—Ç–æ–∫–æ–ª

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–∫–µ—Ç–∞

```
+------------------+
| Header (32 bytes)|
+------------------+
| Version (1 byte) |
| Type (1 byte)    |
| Length (2 bytes) |
| Nonce (12 bytes) |
| Tag (16 bytes)   |
+------------------+
| Encrypted Data   |
+------------------+
```

### –¢–∏–ø—ã –ø–∞–∫–µ—Ç–æ–≤

- `HANDSHAKE (0x01)` - —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
- `HANDSHAKE_RESPONSE (0x02)` - –æ—Ç–≤–µ—Ç –Ω–∞ handshake
- `DATA (0x03)` - –∏–Ω–∫–∞–ø—Å—É–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ IP –ø–∞–∫–µ—Ç—ã
- `KEEPALIVE (0x04)` - –ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
- `DISCONNECT (0x05)` - –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ
- `ERROR (0x06)` - —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
pip install -r requirements.txt
pip install -e .
```

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞

```bash
python -m packetmimic.server [password] [port]
```

–ü—Ä–∏–º–µ—Ä:
```bash
# –° –ø–µ—Ä–µ—Ö–≤–∞—Ç–æ–º —Ç—Ä–∞—Ñ–∏–∫–∞ (—Ç—Ä–µ–±—É–µ—Ç root)
sudo python example_server.py rules.conf

# –ò–ª–∏ —á–µ—Ä–µ–∑ –º–æ–¥—É–ª—å
sudo python -m packetmimic.server my_secure_password 5555
```

### –ó–∞–ø—É—Å–∫ –∫–ª–∏–µ–Ω—Ç–∞

```bash
python -m packetmimic.client <server_host> <server_port> [password]
```

–ü—Ä–∏–º–µ—Ä:
```bash
python example_client.py rules.conf

# –ò–ª–∏ —á–µ—Ä–µ–∑ –º–æ–¥—É–ª—å
python -m packetmimic.client 192.168.1.100 5555 my_secure_password
```

### –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω—ã–π TUN (Linux)

–í–∫–ª—é—á–∞–µ—Ç —Ä–µ–∞–ª—å–Ω–æ–µ —Ç—É–Ω–Ω–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ IP —á–µ—Ä–µ–∑ TUN –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (–Ω—É–∂–µ–Ω root):

1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º `use_tun=True` (–≤ –∫–æ–¥–µ) –∏–ª–∏ —á–µ—Ä–µ–∑ CLI `python -m packetmimic.server ...` (–ø–æ–∫–∞ –±–µ–∑ —Ñ–ª–∞–≥–∞; –≤–∫–ª—é—á–∏—Ç–µ –≤ –∫–æ–¥–µ/–ø—Ä–∏–º–µ—Ä–µ).
2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∏ –º–∞—Ä—à—Ä—É—Ç—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:
   ```bash
   sudo ip link set dev packetmimic0 up
   sudo ip addr add 10.10.0.1/24 dev packetmimic0
   sudo sysctl -w net.ipv4.ip_forward=1
   sudo iptables -t nat -A POSTROUTING -s 10.10.0.0/24 -j MASQUERADE
   ```
3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∫–ª–∏–µ–Ω—Ç–∞ —Å `use_tun=True` –∏ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ:
   ```bash
   sudo ip link set dev packetmimic0 up
   sudo ip addr add 10.10.0.2/24 dev packetmimic0
   sudo ip route add default dev packetmimic0
   ```
4. –ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ —Å–∏—Å—Ç–µ–º–Ω—ã–π —Ç—Ä–∞—Ñ–∏–∫ (–≤–∫–ª—é—á–∞—è YouTube) –ø–æ–π–¥—ë—Ç —á–µ—Ä–µ–∑ TUN ‚Üí VPN.

> macOS/Windows: TUN –ø–æ–∫–∞ –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω (–±—É–¥–µ—Ç Not Implemented). –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Linux.

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–∞–≤–∏–ª —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `rules.conf` —Å –ø—Ä–∞–≤–∏–ª–∞–º–∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏:

```
# –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –ø–æ—Ä—Ç–æ–≤
BLOCK block_suspicious_ports dst_port=4444

# –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ HTTP —Ç—Ä–∞—Ñ–∏–∫–∞
LOG log_http_traffic dst_port=80 protocol=TCP

# –ê–ª–µ—Ä—Ç –Ω–∞ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–π payload
ALERT alert_suspicious payload=cmd.exe
```

## –ü—Ä–æ–≥—Ä–∞–º–º–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

### –°–µ—Ä–≤–µ—Ä

```python
from packetmimic import PacketMimicServer

server = PacketMimicServer(
    host='0.0.0.0',
    port=5555,
    password='your_password'
)
server.start()
```

### –ö–ª–∏–µ–Ω—Ç

```python
from packetmimic import PacketMimicClient

client = PacketMimicClient(
    server_host='192.168.1.100',
    server_port=5555,
    password='your_password'
)
client.start()
```

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- –ü–∞—Ä–æ–ª—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–ª—é—á–∞ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è —á–µ—Ä–µ–∑ PBKDF2-HMAC-SHA256 (100,000 –∏—Ç–µ—Ä–∞—Ü–∏–π)
- –ö–∞–∂–¥—ã–π –ø–∞–∫–µ—Ç —à–∏—Ñ—Ä—É–µ—Ç—Å—è —Å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º nonce (12 –±–∞–π—Ç)
- –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ GCM tag (16 –±–∞–π—Ç)
- –ó–∞—â–∏—Ç–∞ –æ—Ç replay –∞—Ç–∞–∫ —á–µ—Ä–µ–∑ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ nonce
- **–ü–µ—Ä–µ—Ö–≤–∞—Ç –∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞** - —Ç–æ–ª—å–∫–æ —Ç—Ä–∞—Ñ–∏–∫ –æ—Ç –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö VPN –∫–ª–∏–µ–Ω—Ç–æ–≤ —Ä–∞–∑—Ä–µ—à–µ–Ω
- **–°–∏—Å—Ç–µ–º–∞ –ø—Ä–∞–≤–∏–ª —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏** - –≥–∏–±–∫–∞—è —Å–∏—Å—Ç–µ–º–∞ –ø—Ä–∞–≤–∏–ª –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞

## –ü—Ä–æ—Ç–æ–∫–æ–ª

### Handshake –ø—Ä–æ—Ü–µ—Å—Å

1. –ö–ª–∏–µ–Ω—Ç –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–π `client_id`
2. –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç `HANDSHAKE` –ø–∞–∫–µ—Ç —Å `client_id`
3. –°–µ—Ä–≤–µ—Ä –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é
4. –°–µ—Ä–≤–µ—Ä –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç `HANDSHAKE_RESPONSE` —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º

### –ü–µ—Ä–µ–¥–∞—á–∞ –¥–∞–Ω–Ω—ã—Ö

1. IP –ø–∞–∫–µ—Ç –∏–Ω–∫–∞–ø—Å—É–ª–∏—Ä—É–µ—Ç—Å—è –≤ `DATA` –ø–∞–∫–µ—Ç
2. –ü–∞–∫–µ—Ç —à–∏—Ñ—Ä—É–µ—Ç—Å—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º AES-256-GCM
3. –ó–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–∞–∫–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ TCP —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
4. –ü–æ–ª—É—á–∞—Ç–µ–ª—å —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤—ã–≤–∞–µ—Ç –∏ –∏–∑–≤–ª–µ–∫–∞–µ—Ç IP –ø–∞–∫–µ—Ç

### Keepalive

- –ö–ª–∏–µ–Ω—Ç –∏ —Å–µ—Ä–≤–µ—Ä –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç `KEEPALIVE` –ø–∞–∫–µ—Ç—ã –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
- –°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å—á–∏—Ç–∞–µ—Ç—Å—è —Ä–∞–∑–æ—Ä–≤–∞–Ω–Ω—ã–º, –µ—Å–ª–∏ keepalive –Ω–µ –ø–æ–ª—É—á–µ–Ω –≤ —Ç–µ—á–µ–Ω–∏–µ 60 —Å–µ–∫—É–Ω–¥

## –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
PacketMimic/
‚îú‚îÄ‚îÄ packetmimic/
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ protocol.py           # –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ—Ç–æ–∫–æ–ª–∞
‚îÇ   ‚îú‚îÄ‚îÄ server.py             # VPN —Å–µ—Ä–≤–µ—Ä
‚îÇ   ‚îú‚îÄ‚îÄ client.py             # VPN –∫–ª–∏–µ–Ω—Ç
‚îÇ   ‚îú‚îÄ‚îÄ traffic_interceptor.py  # –ü–µ—Ä–µ—Ö–≤–∞—Ç —Ç—Ä–∞—Ñ–∏–∫–∞
‚îÇ   ‚îî‚îÄ‚îÄ traffic_filter.py     # –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Ç—Ä–∞—Ñ–∏–∫–∞ (Snort-like)
‚îú‚îÄ‚îÄ example_server.py         # –ü—Ä–∏–º–µ—Ä —Å–µ—Ä–≤–µ—Ä–∞
‚îú‚îÄ‚îÄ example_client.py         # –ü—Ä–∏–º–µ—Ä –∫–ª–∏–µ–Ω—Ç–∞
‚îú‚îÄ‚îÄ rules.conf                # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–∞–≤–∏–ª —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ setup.py
‚îú‚îÄ‚îÄ requirements.txt
‚îî‚îÄ‚îÄ README.md
```

## –ü–µ—Ä–µ—Ö–≤–∞—Ç –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Ç—Ä–∞—Ñ–∏–∫–∞

### Traffic Interceptor

–ú–æ–¥—É–ª—å `traffic_interceptor.py` –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç:
- –ü–µ—Ä–µ—Ö–≤–∞—Ç –≤—Å–µ—Ö IP –ø–∞–∫–µ—Ç–æ–≤ –Ω–∞ —Å–µ—Ç–µ–≤–æ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –±–ª–æ–∫–∏—Ä–æ–≤–∫—É —Ç—Ä–∞—Ñ–∏–∫–∞ –æ—Ç –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
- –ü–æ–¥–¥–µ—Ä–∂–∫—É —Å–ø–∏—Å–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö IP –∞–¥—Ä–µ—Å–æ–≤ (VPN –∫–ª–∏–µ–Ω—Ç–æ–≤)
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–µ—Ä–µ—Ö–≤–∞—á–µ–Ω–Ω–æ–≥–æ –∏ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞

**–í–ù–ò–ú–ê–ù–ò–ï**: –î–ª—è —Ä–∞–±–æ—Ç—ã –ø–µ—Ä–µ—Ö–≤–∞—Ç—á–∏–∫–∞ —Ç—Ä–µ–±—É—é—Ç—Å—è –ø—Ä–∞–≤–∞ root/administrator!

### Traffic Filter (Snort-like)

–ú–æ–¥—É–ª—å `traffic_filter.py` —Ä–µ–∞–ª–∏–∑—É–µ—Ç —Å–∏—Å—Ç–µ–º—É –ø—Ä–∞–≤–∏–ª —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏:
- **BLOCK** - –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø–∞–∫–µ—Ç–æ–≤
- **ALLOW** - —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –ø–∞–∫–µ—Ç–æ–≤
- **LOG** - –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞–∫–µ—Ç–æ–≤
- **ALERT** - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∞–ª–µ—Ä—Ç–æ–≤ –ø—Ä–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–∏ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞

–ü—Ä–∞–≤–∏–ª–∞ –º–æ–≥—É—Ç —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –ø–æ:
- IP –∞–¥—Ä–µ—Å–∞–º –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –∏ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è (—Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π CIDR)
- –ü–æ—Ä—Ç–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –∏ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è
- –ü—Ä–æ—Ç–æ–∫–æ–ª—É (TCP, UDP, ICMP –∏ –¥—Ä.)
- –ü–∞—Ç—Ç–µ—Ä–Ω–∞–º –≤ payload –ø–∞–∫–µ—Ç–∞

### –ü—Ä–∏–º–µ—Ä—ã –ø—Ä–∞–≤–∏–ª

```conf
# –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –ø–æ—Ä—Ç–æ–≤
BLOCK block_suspicious_ports dst_port=4444

# –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ IP
BLOCK block_malicious_ip src_ip=1.2.3.4

# –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ HTTP —Ç—Ä–∞—Ñ–∏–∫–∞
LOG log_http dst_port=80 protocol=TCP

# –ê–ª–µ—Ä—Ç –Ω–∞ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–π payload
ALERT alert_shell payload=/bin/sh
```

## –ë—É–¥—É—â–∏–µ —É–ª—É—á—à–µ–Ω–∏—è

- [x] –ü–µ—Ä–µ—Ö–≤–∞—Ç –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Ç—Ä–∞—Ñ–∏–∫–∞
- [x] –°–∏—Å—Ç–µ–º–∞ –ø—Ä–∞–≤–∏–ª —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ (Snort-like)
- [ ] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ TUN/TAP –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤ –¥–ª—è —Ä–µ–∞–ª—å–Ω–æ–≥–æ —Ç—É–Ω–Ω–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è
- [ ] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ UDP —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞
- [ ] –ê—Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ–±–º–µ–Ω–∞ –∫–ª—é—á–∞–º–∏
- [ ] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤ —Å –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–µ–π
- [ ] –ö–æ–º–ø—Ä–µ—Å—Å–∏—è –¥–∞–Ω–Ω—ã—Ö
- [ ] –ú–µ—Ç—Ä–∏–∫–∏ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
- [ ] Web-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–∞–≤–∏–ª–∞–º–∏

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License

## –ê–≤—Ç–æ—Ä—ã

PacketMimic Team

